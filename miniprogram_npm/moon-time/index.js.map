{"version":3,"sources":["calculate.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["(function (global, calculate) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = calculate() :\n        typeof define === 'function' && define.amd ? define(calculate) :\n            (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.moonTime = calculate());\n})(this, (function () {\n    \n\n    const MAXYEAR = 2100;\n    const MINYEAR = 2000;\n    const MAXMONTH = 12;\n    const MINMONTH = 1;\n    const MAXDAY = 31;\n    const MINDAY = 1;\n\n    const time = [\n        [2, 25, 30, '1-2-10-11', '3467'],\n        [1, 7, 29, '12', '67', '4'],\n        [2, 18, 29, '12-1-2', '78'],\n        [2, 29, 30, '1245', '8-9-10-11'],\n        [1, 10, 30, '34', '', '2'],\n        [2, 21, 29, '67', '', ''],\n        [1, 2, 29, '89', '', '7'],\n        [2, 13, 30, '12-8-9-10', '1245', ''],\n        [2, 23, 29, '12-1-9-10', '2356', ''],\n        [1, 6, 30, '12', '3-4-5.-6', '5'],\n        [2, 17, 30, '12-1', '67', ''],\n        [2, 27, 29, '12-1-3-4', '78', ''],\n        [1, 8, 29, '34', '', '4'],\n        [2, 20, 30, '56', '', ''],\n        [1, 0, 29, '89', '', '9'],\n        [2, 11, 29, '789', '34', ''],\n        [2, 22, 30, '89', '45', ''],\n        [1, 4, 30, '', '56', '6'],\n        [2, 15, 30, '12-0', '56', ''],\n        [2, 26, 30, '12-1', '6-7-9-10', ''],\n        [1, 7, 30, '234', '67', '4'],\n        [2, 18, 29, '23', '', ''],\n        [2, 29, 30, '56', '', ''],\n        [1, 10, 30, '4578', '2.-3', '2'],\n        [2, 20, 29, '7-8-10-11', '34', ''],\n        [1, 2, 29, '9-10', '45', '6'],\n        [2, 13, 30, '9-10', '4578', ''],\n        [2, 24, 30, '1-2-10-11', '5689', ''],\n        [1, 5, 29, '123', '5.-6-8-9', '5'],\n        [2, 17, 30, '12', '9-10', ''],\n        [2, 28, 30, '12-4-5', '', ''],\n        [1, 8, 29, '2367', '1', '3'],\n        [2, 19, 30, '6-7-9-10', '23', ''],\n        [1, 1, 30, '9-10-11', '34', '11'],\n        [2, 11, 29, '9-10', '34', ''],\n        [2, 22, 29, '12-1-9-10', '4578', ''],\n        [1, 4, 30, '12', '5678', '6'],\n        [2, 16, 30, '12-1-2', '5689', ''],\n        [2, 26, 29, '12-1-2', '9-10', ''],\n        [1, 7, 29, '1245', '', '5'],\n        [2, 17, 29, '3489', '12-0', ''],\n        [2, 29, 30, '6-7-9-10', '12-1', ''],\n        [1, 10, 30, '89', '2.-3', '2'],\n        [2, 21, 30, '12-8-9', '3467', ''],\n        [1, 2, 30, '1', '4-5-7.-7', '7'],\n        [2, 14, 30, '12-1', '4578', ''],\n        [2, 25, 30, '12-1', '89', ''],\n        [1, 6, 30, '134', '89', '5'],\n        [2, 16, 29, '2356', '9-10', ''],\n        [2, 28, 30, '5689', '', ''],\n        [1, 8, 29, '78', '', '3'],\n        [2, 19, 30, '78', '2356', ''],\n        [2, 30, 30, '12-9-10', '3467', '8'],\n        [2, 12, 30, '12-0', '3467', ''],\n        [2, 23, 30, '12-2-3', '4578', ''],\n        [1, 4, 30, '23', '78', '6'],\n        [2, 15, 30, '123', '89', ''],\n        [2, 26, 29, '23', '', ''],\n        [1, 7, 29, '6-7-9-10', '', '4'],\n        [2, 17, 29, '9-10', '12-0', ''],\n        [2, 28, 30, '9-10-11', '2356', ''],\n        [1, 10, 29, '1-2-9-10', '3.-3-5-6', '3'],\n        [2, 21, 30, '1-2-10-11', '3467', ''],\n        [1, 2, 29, '12', '7.-7-', '7'],\n        [2, 13, 29, '12-1-2', '78', ''],\n        [2, 25, 30, '1245', '89', ''],\n        [1, 6, 30, '45', '', '5'],\n        [2, 16, 29, '67', '', ''],\n        [2, 27, 30, '6-7-9-10', '45', ''],\n        [1, 9, 30, '8-9-10', '4.-5', '4'],\n        [2, 19, 29, '9-10', '56', ''],\n        [1, 1, 30, '12-1', '67', '8'],\n        [2, 12, 30, '12-1', '67', ''],\n        [2, 23, 29, '12-1-3-4', '78', ''],\n        [1, 4, 29, '34', '', '6'],\n        [2, 15, 30, '56', '', ''],\n        [2, 25, 29, '89', '', ''],\n        [1, 7, 29, '789', '4.-4', '4'],\n        [2, 18, 30, '89', '45', ''],\n        [2, 29, 30, '12-0', '56', ''],\n        [1, 10, 30, '1', '5689', '3'],\n        [2, 22, 30, '12-2-3', '6-7-9-10', ''],\n        [1, 3, 30, '234', '5-6-9-10', '7'],\n        [2, 14, 30, '12-2-3', '', ''],\n        [2, 24, 30, '56', '', ''],\n        [1, 6, 30, '5.-5-7-8', '34', '5'],\n        [2, 16, 29, '78', '34', ''],\n        [2, 27, 30, '10-11', '45', ''],\n        [1, 8, 30, '9-10', '4.-5-7-8', '4'],\n        [2, 20, 30, '12', '567', ''],\n        [1, 1, 29, '123', '6-7-8.-9', '8'],\n        [2, 12, 30, '12', '9-10', ''],\n        [2, 23, 30, '1245', '', ''],\n        [1, 4, 29, '2-3-6.-7', '1', '6'],\n        [2, 15, 30, '6-7-9-10', '12-1', ''],\n        [2, 25, 29, '9-10-11', '34', ''],\n        [1, 6, 29, '8-9-10', '4.-4-6-7', '4'],\n        [2, 18, 29, '12-1-9-10', '456', ''],\n        [2, 29, 29, '12-1-2', '567', ''],\n        [1, 11, 30, '1234', '5689', '2'],\n        [2, 21, 29, '12-1-2', '9-10', '']\n    ]\n\n    let zodiacYear = function (year) {\n        var zodiac = ['猴', '鸡', '狗', '猪', '鼠', '牛', '虎', '兔', '龙', '蛇', '马', '羊'];\n        return zodiac[year % 12];\n    }\n\n    var lunarYearMeth = function (year) {\n        var gan = ['庚', '辛', '壬', '癸', '甲', '乙', '丙', '丁', '戊', '己'],\n            zhi = ['申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未'],\n            str = year.toString().split(\"\");\n        return gan[str[3]] + zhi[year % 12];\n    }\n\n    var chineseNumber = function (num) {\n        var res;\n        var dateHash = ['', '一', '二', '三', '四', '五', '六', '七', '八', '九', '十'];\n        if (num <= 10) {\n            res = '初' + dateHash[num];\n        } else if (num > 10 && num < 20) {\n            res = '十' + dateHash[num - 10];\n        } else if (num == 20) {\n            res = \"二十\";\n        } else if (num > 20 && num < 30) {\n            res = \"廿\" + dateHash[num - 20];\n        } else if (num == 30) {\n            res = \"三十\";\n        }\n        return res;\n    }\n\n    var getWhetherLeapMonth = (year, leapMonth) => {\n        return time[year][5] == leapMonth ? true : false;\n    }\n\n    var chineseMonth = function (num, leapYear) {\n        var res;\n        var dateHash = ['', '一', '二', '三', '四', '五', '六', '七', '八', '九', '十'];\n        if (num <= 10) {\n            res = dateHash[num];\n        } else if (num > 10 && num < 20) {\n            res = '十' + dateHash[num - 10];\n        }\n        return (getWhetherLeapMonth(leapYear, num) ? '闰' : '') + res + '月';\n    }\n\n    var getConsecutiveMonths = function (msg) {\n\n        if (!msg) return [];\n\n        if (String(msg).indexOf('-') != -1) {\n\n            return String(msg).split('-')\n\n        } else {\n            let str = String(msg);\n\n            let arr = []\n\n            for (let i = 0; i < str.length; i++) {\n\n                arr.push(str[i])\n\n            }\n            return arr;\n        }\n    }\n    function calculate(obj) {\n\n        if (typeof obj == 'object' && !Array.isArray(obj)) {\n\n        } else {\n            throw 'Only receive object type data'\n        }\n\n        if (obj.year > MAXYEAR || obj.year < MINYEAR || obj.month > MAXMONTH || obj.month < MINMONTH || obj.day > MAXDAY || obj.day < MINDAY) {\n\n            throw 'Only receive data from 2000-2100, 1-12 months, 1-31 days'\n\n        }\n\n        let theYear = (obj.year) % MINYEAR;\n\n        let ruleArr = time[theYear]\n\n        let nowDay = parseInt((new Date(`${obj.year}/${obj.month}/${obj.day}`) - new Date(`${obj.year}/1/1`)) / (24 * 60 * 60 * 1000)) + 1\n\n        let leapYear = (ruleArr[0] > 0 ? obj.year-- : obj.year) % MINYEAR\n\n        let month = 12 + 1 - ruleArr[0];\n\n        let oldDay = ruleArr[2] - ruleArr[1] + 1;\n\n        let thirtyMon = getConsecutiveMonths(ruleArr[3]);\n\n        let twentyNineMon = getConsecutiveMonths(ruleArr[4]);\n\n        let nowMonth = 0;\n\n        let isThirty = ruleArr[2] == 30 ? true : false\n\n        let leapMonth = ruleArr[5] ? ruleArr[5] : undefined;\n\n        let isLeapMonth = false;\n\n        let getMonth = function () {\n\n            if (month + 1 > 12) {\n\n                obj.year += 1;\n\n                month = 1;\n\n                isLeapMonth = false;\n\n            } else if (leapMonth) {\n\n                if (month == leapMonth) {\n\n                    obj.leapMonth = month;\n\n                    leapMonth = null;\n\n                    isLeapMonth = true;\n\n                } else {\n\n                    month += 1;\n\n                    isLeapMonth = false;\n\n                }\n            } else {\n\n                month += 1;\n\n                isLeapMonth = false;\n\n            }\n        }\n\n        let getIsThirty = function () {\n\n            if (thirtyMon.find(e => e == month)) {\n\n                if (isLeapMonth) {\n\n                    if (thirtyMon.find(e => String(e) == String(month + '.'))) {\n\n                        isThirty = true;\n\n                    } else {\n\n                        isThirty = !isThirty;\n\n                    }\n                } else if (thirtyMon.find(e => String(e) == String(month))) {\n\n                    isThirty = true;\n\n                } else {\n\n                    isThirty = !isThirty;\n\n                }\n            } else if (ruleArr[4] && twentyNineMon.find(e => e == month)) {\n\n                if (isLeapMonth) {\n\n                    if (twentyNineMon.find(e => String(e) == String(month + '.'))) {\n\n                        isThirty = false;\n\n                    } else {\n\n                        isThirty = !isThirty;\n\n                    }\n                } else if (twentyNineMon.find(e => String(e) == String(month))) {\n\n                    isThirty = false;\n\n                } else {\n\n                    isThirty = !isThirty;\n\n                }\n            } else {\n\n                isThirty = !isThirty;\n\n            }\n        }\n\n        let clear = function () {\n\n            getMonth = null;\n\n            getIsThirty = null;\n        }\n\n        if (nowDay > oldDay) {\n\n            nowDay -= oldDay;\n\n            if (month + 1 > 12) {\n\n                obj.year += 1;\n\n                month = 1;\n\n            } else {\n\n                month += 1;\n\n            }\n\n            getIsThirty();\n\n            while (true) {\n\n                //30/29\n                if (nowDay > (isThirty ? 30 : 29)) {\n\n                    nowDay -= (isThirty ? 30 : 29)\n\n                    getMonth();\n\n                    getIsThirty();\n\n                } else {\n                    break;\n                }\n            }\n\n            clear();\n            clear = null;\n\n            return Object.assign(obj, {\n\n                month: month,\n\n                day: nowDay,\n\n                zodiac: zodiacYear(obj.year),\n\n                lunarYear: lunarYearMeth(obj.year),\n\n                dayC: chineseNumber(nowDay),\n\n                monthC: chineseMonth(month, leapYear)\n\n            })\n        } else {\n\n            clear();\n            clear = null;\n\n            return Object.assign(obj, {\n\n                month,\n\n                day: ruleArr[1] + nowDay - 1,\n\n                zodiac: zodiacYear(obj.year),\n\n                lunarYear: lunarYearMeth(obj.year),\n\n                dayC: chineseNumber(ruleArr[1] + nowDay - 1),\n\n                monthC: chineseMonth(month, leapYear)\n\n            })\n        }\n    }\n\n    return calculate;\n\n}))"]}